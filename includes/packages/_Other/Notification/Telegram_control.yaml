telegram_control:

#########################################################################################################################################
#                                                            –®–∞–±–ª–æ–Ω—ã 
#########################################################################################################################################


#########################################################################################################################################
#                                                            –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ 
#########################################################################################################################################

    automation:

######################################### –°—Ç–∞—Ä—Ç–æ–≤–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –º–µ–Ω—é ######################################################

      - id: –í—ã–∑–æ–≤ –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: (Telegram) –í—ã–∑–æ–≤ –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        initial_state: true
        trigger:
          - platform: event
            event_type: telegram_text
        condition:
          - condition: template
            value_template: >-
              {{ trigger.event.data.text in ["–∫—É", "–ö—É", "Re", "re", "–∫—É–∫—É", "–ö—É–∫—É", "Rere", "rere", "–ü—Ä–∏–≤–µ—Ç", "–ø—Ä–∏–≤–µ—Ç", "Ghbdtn", "ghbdtn"] }}
        action:
        #   - choose:
        #       - conditions:
        #           - condition: template
        #             value_template: >
        #               {{ trigger.event.data.user_id == (states('sensor.admin_tg_id')|int) }}
        #         sequence:
                  - service: telegram_bot.send_message
                    data:
                      target: "{{ trigger.event.data.user_id }}"
                      message: |
                        {{'\U0001F527'}} *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–º–Ω—ã–º –¥–æ–º–æ–º*
                        * *
                        *–ù–∞ —É–ª–∏—Ü–µ* {{'\U0001F321'}} - {{ states('sensor.a4c138bfa633_temperature') }} ¬∞C, {{'\U0001F4A7'}} - {{ states('sensor.a4c138bfa633_humidity') }} %
                        * *
                        {{'\U0001F4BB'}} *CPU* - {{ states('sensor.processor_use') }} %, {{'\U0001F321'}} - {{ states('sensor.processor_temperature') }} ¬∞C
                      inline_keyboard:
                      - '{{''\U0001F4BE''}} –°–∏—Å—Ç–µ–º–Ω–∞—è:/system_data , {{''\U0001F527''}} –†–µ–∂–∏–º—ã:/mode'
                      - '{{''\U0001F6B6''}} –ö–æ—Ä–∏–¥–æ—Ä:/en_control , {{''\U0001F6C0''}} –°–∞–Ω—É–∑–µ–ª:/bt_control'
                      - '{{''üõã''}} –ì–æ—Å—Ç–∏–Ω–∞—è:/lr_control , {{''üõè''}} –°–ø–∞–ª—å–Ω—è:/br_control , {{''\U0001F374''}} –ö—É—Ö–Ω—è:/kn_control'
                      - '{{''\U0001F6AB''}} –£–±—Ä–∞—Ç—å –º–µ–Ω—é:/menu_hide'

############################################# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥–ª–∞–≤–Ω—ã–º –º–µ–Ω—é ######################################################
 
      - id: –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: (Telegram) –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        initial_state: true
        trigger:
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/menu_hide'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/menu_back'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: "{{ trigger.event.data.chat_id }}"
                      message: |
                        {{'\U0001F527'}} *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–º–Ω—ã–º –¥–æ–º–æ–º*
                        * *
                        *–ù–∞ —É–ª–∏—Ü–µ* {{'\U0001F321'}} - {{ states('sensor.a4c138bfa633_temperature') }} ¬∞C, {{'\U0001F4A7'}} - {{ states('sensor.a4c138bfa633_humidity') }} %
                        * *
                        {{'\U0001F4BB'}} *CPU* - {{ states('sensor.processor_use') }} %, {{'\U0001F321'}} - {{ states('sensor.processor_temperature') }} ¬∞C
                      inline_keyboard:
                      - '{{''\U00002328''}} –°–∏—Å—Ç–µ–º–Ω–∞—è:/system_data , {{''\U0001F527''}} –†–µ–∂–∏–º—ã:/mode' 
                      - '{{''\U0001F6B6''}} –ö–æ—Ä–∏–¥–æ—Ä:/en_control , {{''\U0001F6C0''}} –°–∞–Ω—É–∑–µ–ª:/bt_control'
                      - '{{''üõã''}} –ì–æ—Å—Ç–∏–Ω–∞—è:/lr_control , {{''üõè''}} –°–ø–∞–ª—å–Ω—è:/br_control , {{''\U0001F374''}} –ö—É—Ö–Ω—è:/kn_control'
                      - '{{''\U0001F6AB''}} –£–±—Ä–∞—Ç—å –º–µ–Ω—é:/menu_hide'

#=======================================================================================================================================
############################################################### –†–µ–∂–∏–º—ã #################################################################
#=======================================================================================================================================

      - id: –†–µ–∂–∏–º—ã –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: (Telegram) –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞–º–∏
        initial_state: true
        trigger:
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/mode'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}' 
                  - service: telegram_bot.send_message
                    data:
                      target: "{{ trigger.event.data.chat_id }}"
                      message:  &msg_mode |
                        {{'\U0001F527'}} *–†–µ–∂–∏–º—ã :*
                      inline_keyboard: &keyb_mode
                        - '{{''\U0001F4A4''}} –î–∏–º–∞ —Å–ø–∏—Ç - {% if is_state(''input_boolean.dima_sleep'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_dima_sleep , {{''\U0001F4A1''}} –ê–≤—Ç–æ. –ì–∞—Ä–¥–µ—Ä–æ–± - {% if is_state(''automation.garderobnaia_vkl_svet_pri_dvizhenii'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_auto_garderobnaia'
                        - '{{''\U0001F487''}} –°—Ç—Ä–∏–∂–∫–∞ - {% if is_state(''input_boolean.strijka'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_strijka , {{''\U0001F455''}} –°—É—à–∫–∞ - {% if is_state(''input_boolean.syshka'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_syshka'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/menu_back , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/mode' 
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_dima_sleep'' }}'
                sequence:
                  - service: input_boolean.toggle
                    entity_id: input_boolean.dima_sleep
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –†–µ–∂–∏–º "–î–∏–º–∞ —Å–ø–∏—Ç" - {% if is_state('input_boolean.dima_sleep', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %} 
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_mode
                      inline_keyboard: *keyb_mode
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_auto_garderobnaia'' }}'
                sequence:
                  - service: automation.toggle
                    entity_id: automation.garderobnaia_vkl_svet_pri_dvizhenii
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ì–∞—Ä–¥–µ—Ä–æ–±–Ω–æ–π - {% if is_state('automation.garderobnaia_vkl_svet_pri_dvizhenii', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %} 
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_mode
                      inline_keyboard: *keyb_mode
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_strijka'' }}'
                sequence:
                  - service: input_boolean.toggle
                    entity_id: input_boolean.strijka
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –†–µ–∂–∏–º "–°—Ç—Ä–∏–∂–∫–∏" - {% if is_state('input_boolean.strijka', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %} 
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_mode
                      inline_keyboard: *keyb_mode
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_syshka'' }}'
                sequence:
                  - service: input_boolean.toggle
                    entity_id: input_boolean.syshka
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –†–µ–∂–∏–º "–°—É—à–∫–∏" - {% if is_state('input_boolean.syshka', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %} 
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_mode
                      inline_keyboard: *keyb_mode

#=======================================================================================================================================
####################################################### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–∏–¥–æ—Ä–æ–º ###########################################################
#=======================================================================================================================================

      - id: –ö–æ—Ä–∏–¥–æ—Ä –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: (Telegram) –ö–æ—Ä–∏–¥–æ—Ä –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        initial_state: true
        trigger:
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/en_control'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}' 
                  - service: telegram_bot.send_message
                    data:
                      target: "{{ trigger.event.data.chat_id }}"
                      message:  &msg_en |
                        {{'\U0001F6B6'}} *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–∏–¥–æ—Ä–æ–º :*
                        * *
                        {{'\U0001F6AA'}} –í—Ö–æ–¥–Ω–∞—è –¥–≤–µ—Ä—å - {% if is_state('binary_sensor.0x158d0001dff57f_contact', 'on') %} –û—Ç–∫—Ä—ã—Ç–∞ {% else %} –ó–∞–∫—Ä—ã—Ç–∞ {% endif %}
                        {{'\U0001F6B6'}} –î–∞—Ç—á–∏–∫ - {% if is_state('binary_sensor.0x158d0003fb0f3a_motion', 'on') %} –î–≤–∏–∂–µ–Ω–∏–µ {% else %} –ù–µ—Ç –¥–≤–∏–∂–µ–Ω–∏—è {% endif %} 
                        {{'\U0001F6B6'}} –ù–æ—á–Ω–∏–∫ - {% if is_state('binary_sensor.28d1272f330d_motion', 'on') %} –î–≤–∏–∂–µ–Ω–∏–µ {% else %} –ù–µ—Ç –¥–≤–∏–∂–µ–Ω–∏—è {% endif %} 
                        {{'\U0001F50B'}} –ó–∞—Ä—è–¥ –ø–ª–∞–Ω—à–µ—Ç–∞ - {{ states('sensor.galaxy_tab_a8_battery_level') }} %
                      inline_keyboard: &keyb_en
                        - '{{''\U0001F4A1''}} –õ—é—Å—Ç—Ä–∞ - {% if is_state(''switch.svet_v_koridore'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_en_ceiling_light , {{''\U0001F4A1''}} –õ–µ–Ω—Ç–∞ - {% if is_state(''switch.lenta_v_koridore'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_en_led_light'
                        - '{{''\U0001F50C''}} –ü–ª–∞–Ω—à–µ—Ç–∞ - {% if is_state(''switch.planshet'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_en_planshet_switch , {{''\U0001F4DF''}} –≠–∫—Ä–∞–Ω –ø–ª–∞–Ω—à–µ—Ç–∞ - {% if is_state(''light.galaxy_tab_a8_screen'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_en_planshet_screen_light'
                        - '{{''\U0001F3B6''}} Spotify:/toggle_en_spotify'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/menu_back , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/en_control' 
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_en_led_light'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.lenta_v_koridore
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ–µ–Ω—Ç–∞ –≤ –∫–æ—Ä–∏–¥–æ—Ä–µ - {% if is_state('switch.lenta_v_koridore', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %} 
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_en
                      inline_keyboard: *keyb_en
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_en_ceiling_light'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.svet_v_koridore
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ—é—Å—Ç—Ä–∞ –≤ –∫–æ—Ä–∏–¥–æ—Ä–µ - {% if is_state('switch.svet_v_koridore', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_en
                      inline_keyboard: *keyb_en
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_en_planshet_switch'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.planshet
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –†–æ–∑–µ—Ç–∫–∞ –ø–ª–∞–Ω—à–µ—Ç–∞ - {% if is_state('switch.planshet', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %} 
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_en
                      inline_keyboard: *keyb_en
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_en_planshet_screen_light'' }}'
                sequence:
                  - service: light.toggle
                    entity_id: light.galaxy_tab_a8_screen
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –≠–∫—Ä–∞–Ω –ø–ª–∞–Ω—à–µ—Ç–∞ - {% if is_state('light.galaxy_tab_a8_screen', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %} 
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_en
                      inline_keyboard: *keyb_en
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_en_spotify'' }}'
                sequence:
                  - service: light.turn_on
                    entity_id: light.galaxy_tab_a8_screen
                  - delay: 00:00:01
                  - service: fullykiosk.start_application
                    data:
                      entity_id: media_player.galaxy_tab_a8_media_player
                      application: com.spotify.music
                  - delay: 00:00:02
                  - service: fullykiosk.volume_set
                    data:
                      entity_id: media_player.galaxy_tab_a8_media_player
                      volume_level: 0.5
                      stream: 3
                  - delay: 00:00:05
                  - service: spotcast.start
                    data:
                      spotify_device_id: "700f4547243c97e368e4784bb4cba02348e7"
                      uri: spotify:playlist:6fBj1CABsDXgPngrP
                      force_playback: true
                      random_song: true
                      shuffle: true
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} Spotify –∑–∞–ø—É—â–µ–Ω
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_en
                      inline_keyboard: *keyb_en

#=======================================================================================================================================
####################################################### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –°–∞–Ω—É–∑–ª–æ–º ###########################################################
#=======================================================================================================================================

      - id: –¢—É–∞–ª–µ—Ç, –≤–∞–Ω–Ω–∞—è –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: (Telegram) –¢—É–∞–ª–µ—Ç, –≤–∞–Ω–Ω–∞—è –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        initial_state: true
        trigger: 
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/bt_control'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: &msg_bt |
                        {{'\U0001F6C0'}} *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—É–∞–ª–µ—Ç–æ–º, –≤–∞–Ω–Ω–æ–π :*
                        * *
                        –¢—É–∞–ª–µ—Ç: 
                        {{'\U0001F6AA'}} –î–≤–µ—Ä—å - {% if is_state('binary_sensor.0x158d00028d3838_contact', 'on') %} –û—Ç–∫—Ä—ã—Ç–∞ {% else %} –ó–∞–∫—Ä—ã—Ç–∞ {% endif %}
                        {{'\U0001F6B6'}} - {% if is_state('binary_sensor.0x158d00067919d1_motion', 'on') %} –î–≤–∏–∂–µ–Ω–∏–µ {% else %} –ù–µ—Ç –¥–≤–∏–∂–µ–Ω–∏—è {% endif %}
                        {{'\U0001F6B1'}} –£–º—ã–≤–∞–ª—å–Ω–∏–∫ - {% if is_state('binary_sensor.54ef44e5ca71_water_leak', 'on') %} –ü—Ä–æ—Ç–µ—á–∫–∞ {% else %} –°—É—Ö–æ {% endif %}

                        –í–∞–Ω–Ω–∞—è:
                        {{'\U0001F6AA'}} –î–≤–µ—Ä—å - {% if is_state('binary_sensor.0x158d00069b0949_contact', 'on') %} –û—Ç–∫—Ä—ã—Ç–∞ {% else %} –ó–∞–∫—Ä—ã—Ç–∞ {% endif %}
                        {{'\U0001F6B6'}} - {% if is_state('binary_sensor.0x158d00067963a8_motion', 'on') %} –î–≤–∏–∂–µ–Ω–∏–µ {% else %} –ù–µ—Ç –¥–≤–∏–∂–µ–Ω–∏—è {% endif %}
                        {{'\U0001F6B1'}} –ü–æ–¥ –°—Ç–∏—Ä–∞–ª–∫–æ–π - {% if is_state('binary_sensor.54ef44e5d062_water_leak', 'on') %} –ü—Ä–æ—Ç–µ—á–∫–∞ {% else %} –°—É—Ö–æ {% endif %}
                      inline_keyboard: &keyb_bt
                        - '{{''\U0001F4A1''}} –¢—É–∞–ª–µ—Ç - {% if is_state(''switch.svet_v_tualete'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_tt_ceiling_light , {{''\U0001F300''}} –í—ã—Ç—è–∂–∫–∞ - {% if is_state(''switch.vytiazhka_v_tualete'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_tt_fan'
                        - '{{''\U0001F4A1''}} –í–∞–Ω–Ω–∞—è - {% if is_state(''switch.svet_v_vannoi'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_bt_ceiling_light , {{''\U0001F4A1''}} –õ–µ–Ω—Ç–∞ - {% if is_state(''switch.lenta_v_vannoi'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_bt_led'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/menu_back , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/bt_control' 
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_tt_ceiling_light'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.svet_v_tualete
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –°–≤–µ—Ç –≤ —Ç—É–∞–ª–µ—Ç–µ - {% if is_state('switch.svet_v_tualete', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_bt
                      inline_keyboard: *keyb_bt
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_tt_fan'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.vytiazhka_v_tualete
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –í—ã—Ç—è–∂–∫–∞ –≤ —Ç—É–∞–ª–µ—Ç–µ - {% if is_state('switch.vytiazhka_v_tualete', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_bt
                      inline_keyboard: *keyb_bt
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_bt_ceiling_light'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.svet_v_vannoi
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –°–≤–µ—Ç –≤ –≤–∞–Ω–Ω–æ–π - {% if is_state('switch.svet_v_vannoi', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_bt
                      inline_keyboard: *keyb_bt

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_bt_led'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.lenta_v_vannoi
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ–µ–Ω—Ç–∞ –≤ –≤–∞–Ω–Ω–æ–π - {% if is_state('switch.lenta_v_vannoi', 'on') %} –í–∫–ª—é—á–µ–Ω–∞ {% else %} –í—ã–∫–ª—é—á–µ–Ω–∞ {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_bt
                      inline_keyboard: *keyb_bt


#=======================================================================================================================================
####################################################### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ì–æ—Å—Ç–∏–Ω–æ–π ###########################################################
#=======================================================================================================================================

      - id: –ì–æ—Å—Ç–∏–Ω–∞—è, –≥–∞—Ä–¥–µ—Ä–æ–±, –ª–æ–¥–∂–∏—è –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: (Telegram) –ì–æ—Å—Ç–∏–Ω–∞—è, –≥–∞—Ä–¥–µ—Ä–æ–±, –ª–æ–¥–∂–∏—è –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        initial_state: true
        trigger: 
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/lr_control'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: &msg_lr |
                        {{'üõã'}} *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ì–æ—Å—Ç–∏–Ω–æ–π, –≥–∞—Ä–¥–µ—Ä–æ–±–Ω–æ–π –∏ –ª–æ–¥–∂–∏–µ–π :*
                        * *
                        –ì–æ—Å—Ç–∏–Ω–∞—è: 
                        {{'\U0001F321'}} - {{ states('sensor.a4c138f9ce31_temperature') }} ¬∞C, {{'\U0001F4A7'}} - {{ states('sensor.a4c138f9ce31_humidity') }} %

                        –ì–∞—Ä–¥–µ—Ä–æ–±–Ω–∞—è:
                        {{'\U0001F6B6'}} - {% if is_state('binary_sensor.0x158d00062fdc4f_motion', 'on') %} –î–≤–∏–∂–µ–Ω–∏–µ {% else %} –ù–µ—Ç –¥–≤–∏–∂–µ–Ω–∏—è {% endif %}
                      inline_keyboard: &keyb_lr
                        - '{{''\U0001F4A1''}} –õ—é—Å—Ç—Ä–∞- {% if is_state(''switch.liustra_v_gostinoi'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_lr_light , {{''\U0001F4A1''}} –õ–µ–Ω—Ç–∞- {% if is_state(''switch.lenta_v_gostinoi'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_lr_led , {{''\U0001F4A1''}} –°–≤–µ—Ç - {% if is_state(''switch.svet_v_gostinoi'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_lr_ceiling_light'
                        - '{{''\U0001F4A1''}} –°–≤–µ—Ç –≤ –ì–∞—Ä–¥–µ—Ä–æ–± - {% if is_state(''switch.svet_v_garderobnoi'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_dr_ceiling_light , {{''\U0001F3EE''}} –ù–æ—á–Ω–∏–∫ - {% if is_state(''light.bslamp2_cloud_402265'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_lr_night_light'
                        - '{{''\U0001F4A1''}} –°–≤–µ—Ç –Ω–∞ –ª–æ–¥–∂–∏–∏ - {% if is_state(''switch.svet_na_lodzhii'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_lo_ceiling_light , {{''\U0001F4A1''}} –õ–µ–Ω—Ç–∞ - {% if is_state(''switch.lenta_na_lodzhii'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_lo_led'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/menu_back , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/lr_control' 
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_lr_light'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.liustra_v_gostinoi
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ—é—Å—Ç—Ä–∞ –≤ –≥–æ—Å—Ç–∏–Ω–æ–π - {% if is_state('switch.liustra_v_gostinoi', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr
                      inline_keyboard: *keyb_lr

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_lr_led'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.lenta_v_gostinoi
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ–µ–Ω—Ç–∞ –≤ –≥–æ—Å—Ç–∏–Ω–æ–π - {% if is_state('switch.lenta_v_gostinoi', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr
                      inline_keyboard: *keyb_lr

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_lr_ceiling_light'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.svet_v_gostinoi
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –°–≤–µ—Ç –≤ –≥–æ—Å—Ç–∏–Ω–æ–π - {% if is_state('switch.svet_v_gostinoi', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr
                      inline_keyboard: *keyb_lr

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_dr_ceiling_light'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.svet_v_garderobnoi
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –°–≤–µ—Ç –≤ –≥–∞—Ä–¥–µ—Ä–æ–±–Ω–æ–π - {% if is_state('switch.svet_v_garderobnoi', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr
                      inline_keyboard: *keyb_lr

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_lr_night_light'' }}'
                sequence:
                  - service: light.toggle
                    entity_id: light.bslamp2_cloud_402265
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –ù–æ—á–Ω–∏–∫ - {% if is_state('light.bslamp2_cloud_402265', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr
                      inline_keyboard: *keyb_lr

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_lo_ceiling_light'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.svet_na_lodzhii
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –°–≤–µ—Ç –Ω–∞ –õ–æ–¥–∂–∏–∏ - {% if is_state('switch.svet_na_lodzhii', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr
                      inline_keyboard: *keyb_lr

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_lo_led'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.lenta_na_lodzhii
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ–µ–Ω—Ç–∞ –Ω–∞ –õ–æ–¥–∂–∏–∏ - {% if is_state('switch.lenta_na_lodzhii', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_lr
                      inline_keyboard: *keyb_lr


#=======================================================================================================================================
####################################################### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –°–ø–∞–ª—å–Ω–µ–π ###########################################################
#=======================================================================================================================================

      - id: –°–ø–∞–ª—å–Ω—è, –∫–∞–±–∏–Ω–µ—Ç –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: (Telegram) –°–ø–∞–ª—å–Ω—è, –∫–∞–±–∏–Ω–µ—Ç –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        initial_state: true
        trigger: 
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/br_control'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: &msg_br |
                        {{'üõè'}} *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –°–ø–∞–ª—å–Ω–µ–π –∏ –∫–∞–±–∏–Ω–µ—Ç–æ–º :*
                        * *
                        –°–ø–∞–ª—å–Ω—è: 
                        {{'\U0001F321'}} - {{ states('sensor.a4c138c67cbc_temperature') }} ¬∞C, {{'\U0001F4A7'}} - {{ states('sensor.a4c138c67cbc_humidity') }} %
                      inline_keyboard: &keyb_br
                        - '{{''\U0001F4A1''}} –°–≤–µ—Ç –≤ —Å–ø–∞–ª—å–Ω–µ - {% if is_state(''switch.svet_v_spalne'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_br_ceiling_light , {{''\U0001F4A1''}} –õ–µ–Ω—Ç–∞- {% if is_state(''switch.lenta_v_spalne'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_br_led'
                        - '{{''\U0001F4A1''}} –°–≤–µ—Ç –≤ –∫–∞–±–∏–Ω–µ—Ç–µ - {% if is_state(''switch.svet_v_kabinete'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_kb_ceiling_light , {{''‚õ≤Ô∏è''}} –£–≤–ª–∞–∂–Ω–∏—Ç–µ–ª—å:/br_humidifier'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/menu_back , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/br_control' 
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_br_ceiling_light'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.svet_v_spalne
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –°–≤–µ—Ç –≤ —Å–ø–∞–ª—å–Ω–µ - {% if is_state('switch.svet_v_spalne', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_br
                      inline_keyboard: *keyb_br

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_br_led'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.lenta_v_spalne
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ–µ–Ω—Ç–∞ –≤ —Å–ø–∞–ª—å–Ω–µ - {% if is_state('switch.lenta_v_spalne', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_br
                      inline_keyboard: *keyb_br

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_kb_ceiling_light'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.svet_v_kabinete
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –°–≤–µ—Ç –≤ –∫–∞–±–∏–Ω–µ—Ç–µ - {% if is_state('switch.svet_v_kabinete', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_br
                      inline_keyboard: *keyb_br

####################################################### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –£–≤–ª–∞–∂–Ω–∏—Ç–µ–ª–µ–º ############################################################

      - id: –ú–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–≤–ª–∞–∂–Ω–∏—Ç–µ–ª–µ–º –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–µ
        alias: (Telegram) –ú–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–≤–ª–∞–∂–Ω–∏—Ç–µ–ª–µ–º
        initial_state: true
        trigger:
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/br_humidifier'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}' 
                  - service: telegram_bot.send_message
                    data:
                      target: "{{ trigger.event.data.chat_id }}"
                      message:  &msg_ah |
                        {{'‚õ≤'}} *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –£–≤–ª–∞–∂–Ω–∏—Ç–µ–ª–µ–º :*
                        * *
                        {{'\U0001F321'}} - {{ states('sensor.humidifier_temperature') }} ¬∞C, {{'\U0001F4A7'}} - {{ states('sensor.humidifier_humidity') }} %
                        {{'\U0001F449'}} *–í–æ–¥—ã –≤ Mi –£–≤–ª–∞–∂–Ω–∏—Ç–µ–ª–µ* - {% if is_state('binary_sensor.humidifier_water', 'on') %} {{'\U000026A0'}} *–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç* {% else %} {{'\U0001F197'}} {% endif %}
                        {{'\U0001F449'}} *–†–µ–∑–µ—Ä–≤—É–∞—Ä Mi –£–≤–ª–∞–∂–Ω–∏—Ç–µ–ª—è* - {% if is_state('binary_sensor.humidifier_water_tank', 'on') %} {{'\U000026A0'}} *–°–Ω—è—Ç* {% else %} {{'\U0001F197'}} {% endif %}
                        {{'\U0001F4F6'}} *Mi –£–≤–ª–∞–∂–Ω–∏—Ç–µ–ª—å* - {% if is_state('device_tracker.b4_60_ed_4a_c5_0c', 'home') %} *–≤ —Å–µ—Ç–∏* {% else %} *–æ—Ñ—Ñ–ª–∞–π–Ω* {% endif %}
                        {{'\U0001F527'}} –†–µ–∂–∏–º Mi –£–≤–ª–∞–∂–Ω–∏—Ç–µ–ª—è - *{{ states('input_select.humidifier_mode') }}*
                      inline_keyboard: &keyb_ah
                        - '{{''üñ±''}} Mi –£–≤–ª–∞–∂–Ω–∏—Ç–µ–ª—å - {% if is_state(''fan.humidifier_xiaomi'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_br_humidifier'
                        - '{{''\U0001F4A1''}} LED - {% if is_state(''switch.xiaomi_humidifier_led'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/LED_humidifier , {{''\U0001F50A''}} –ó–≤—É–∫ - {% if is_state(''switch.xiaomi_humidifier_buzzer'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/buz_humidifier'
                        - '{{''\U0001F527''}} –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞:/toggle_mode_humidifier'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/br_control , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/br_humidifier'

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_br_humidifier'' }}'
                sequence:
                  - service: fan.toggle
                    entity_id: fan.humidifier_xiaomi
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} Mi –£–≤–ª–∞–∂–Ω–∏—Ç–µ–ª—å - {% if is_state('fan.humidifier_xiaomi', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_ah
                      inline_keyboard: *keyb_ah

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/LED_humidifier'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.xiaomi_humidifier_led
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} LED –Ω–∞ Mi –£–≤–ª–∞–∂–Ω–∏—Ç–µ–ª–µ - {% if is_state('switch.xiaomi_humidifier_led', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_ah
                      inline_keyboard: *keyb_ah

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/buz_humidifier'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.xiaomi_humidifier_buzzer
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –ó–≤—É–∫ –Ω–∞ Mi –£–≤–ª–∞–∂–Ω–∏—Ç–µ–ª–µ - {% if is_state('switch.xiaomi_humidifier_buzzer', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_ah
                      inline_keyboard: *keyb_ah

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_mode_humidifier'' }}'
                sequence:
                  - service: input_select.select_next
                    entity_id: input_select.humidifier_mode
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –°–ª–µ–¥—É—é—â–∏–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã Mi –£–≤–ª–∞–∂–Ω–∏—Ç–µ–ª—è
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_ah
                      inline_keyboard: *keyb_ah





#=======================================================================================================================================
####################################################### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ö—É—Ö–Ω–µ–π ###########################################################
#=======================================================================================================================================

      - id: –ö—É—Ö–Ω—è –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º
        alias: (Telegram) –ö—É—Ö–Ω—è –º–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        initial_state: true
        trigger: 
          - platform: event
            event_type: telegram_callback
            event_data: {}
        action:
          - choose:
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/kn_control'' }}'
                sequence:
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: &msg_kn |
                        {{'\U0001F374'}} *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ö—É—Ö–Ω–µ–π :*
                        * *
                        {{'\U0001F321'}} - {{ states('sensor.a4c138ea1a11_temperature') }} ¬∞C, {{'\U0001F4A7'}} - {{ states('sensor.a4c138ea1a11_humidity') }} %
                        {{'\U0001F6B6'}} - {% if is_state('binary_sensor.0x158d0006337230_motion', 'on') %} –î–≤–∏–∂–µ–Ω–∏–µ {% else %} –ù–µ—Ç –¥–≤–∏–∂–µ–Ω–∏—è {% endif %}
                        {{'\U0001F6B1'}} –ú–æ–π–∫–∞ - {% if is_state('binary_sensor.54ef44e5d0d9_water_leak', 'on') %} –ü—Ä–æ—Ç–µ—á–∫–∞ {% else %} –°—É—Ö–æ {% endif %}
                      inline_keyboard: &keyb_kn
                        - '{{''\U0001F4A1''}} –°–≤–µ—Ç –Ω–∞–¥ —Å—Ç–æ–ª–æ–º - {% if is_state(''switch.svet_nad_stolom'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_kn_light , {{''\U0001F4A1''}} –õ–µ–Ω—Ç–∞- {% if is_state(''switch.lenta_na_kukhne'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_kn_led'
                        - '{{''\U0001F4A1''}} –°–≤–µ—Ç –Ω–∞ –∫—É—Ö–Ω–µ - {% if is_state(''switch.svet_nad_stoleshnei'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_kn_ceiling_light , {{''\U00002615''}} –ß–∞–π–Ω–∏–∫- {% if is_state(''switch.chainik'', ''off'')%}{{''üî¥''}}{% else %}{{''üü¢''}}{% endif %}:/toggle_kn_chainik'
                        - '{{''\U000021A9''}} –í–µ—Ä–Ω—É—Ç—å—Å—è:/menu_back , {{''\U000021AA''}} –û–±–Ω–æ–≤–∏—Ç—å:/kn_control' 
              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_kn_light'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.svet_nad_stolom
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ—é—Å—Ç—Ä–∞ –Ω–∞ –∫—É—Ö–Ω–µ - {% if is_state('switch.svet_nad_stolom', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_kn
                      inline_keyboard: *keyb_kn

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_kn_led'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.lenta_na_kukhne
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –õ–µ–Ω—Ç–∞ –Ω–∞ –∫—É—Ö–Ω–µ - {% if is_state('switch.lenta_na_kukhne', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_kn
                      inline_keyboard: *keyb_kn

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_kn_ceiling_light'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.svet_nad_stoleshnei
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –°–≤–µ—Ç –Ω–∞ –∫—É—Ö–Ω–µ - {% if is_state('switch.svet_nad_stoleshnei', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_kn
                      inline_keyboard: *keyb_kn

              - conditions:
                  - condition: template
                    value_template: '{{ trigger.event.data.command == ''/toggle_kn_chainik'' }}'
                sequence:
                  - service: switch.toggle
                    entity_id: switch.chainik
                  - delay:
                      milliseconds: 500
                  - service: telegram_bot.answer_callback_query
                    data:
                      callback_query_id: "{{ trigger.event.data.id }}"
                      message: | 
                          {{"\U0001F4AC"}} –ß–∞–π–Ω–∏–∫ - {% if is_state('switch.chainik', 'on') %} –í–∫–ª—é—á–µ–Ω {% else %} –í—ã–∫–ª—é—á–µ–Ω {% endif %}
                  - service: telegram_bot.delete_message
                    data_template:
                      message_id: '{{ trigger.event.data.message.message_id }}'
                      chat_id: '{{ trigger.event.data.chat_id }}'
                  - service: telegram_bot.send_message
                    data:
                      target: '{{ trigger.event.data.chat_id }}'
                      message: *msg_kn
                      inline_keyboard: *keyb_kn



























